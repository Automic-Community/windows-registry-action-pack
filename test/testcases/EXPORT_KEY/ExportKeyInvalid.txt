*** Settings ***
Suite Setup       Suite Setup
Force Tags        add key    valid    win
Test Template     Add Key Template
Resource          ../../resources/keywords.txt

*** Variables ***

*** Test Cases ***    Key Name                    Value                       Separator    Data type    Assign data    Key Name                       File
Export Key Invalid Without Value To Readonly Folder
                      HKCR\\.1WinRegistryTest1    Testing Registry 1          \            REG_SZ       \              HKCR\\.1WinRegistryTest1       ${_WORKING_DIR}\\readonly

Export Key Invalid With Value To HKCR To Readonly Folder
                      HKCR\\.1WinRegistryTest     Testing Windows Registry    \            REG_SZ       999999         HKCR\\.1WinRegistryTesting     ${_WORKING_DIR}\\readonly

Export Key Invalid With Value To HKLM Root To Readonly Folder
                      HKLM                        Testing Windows Registry    \            REG_SZ       999999         HKLM                           ${_WORKING_DIR}\\readonly

Export Key Invalid With Value To HKU Root To Readonly Folder
                      HKU                         Testing Windows Registry    \            REG_SZ       999999         HKU                            ${_WORKING_DIR}\\readonly

Export Key Invalid With Value To HKCU To Readonly Folder
                      HKCU\\.1WinRegistryTest     Testing Windows Registry    \            REG_SZ       999999         HKCU\\.1WinRegistryTesting     ${_WORKING_DIR}\\readonly

Export Key Invalid With Value to HKCC To Readonly Folder
                      HKCC\\.1WinRegistryTest     Testing Windows Registry    \            REG_SZ       999999         HKCC\\.1WinRegistryTesting     ${_WORKING_DIR}\\readonly

Export Key Invalid Without Value To Invalid Folder
                      HKCR\\.1WinRegistryTest1    Testing Registry 1          \            REG_SZ       \              HKCR\\.1WinRegistryTest1       ${_WORKING_DIR}\\readonly

Export Key Invalid With Value To HKCR To Invalid Folder
                      HKCR\\.1WinRegistryTest     Testing Windows Registry    \            REG_SZ       999999         HKCR\\.1WinRegistryTesting     ${_WORKING_DIR}\\invalid\\invalid1.reg

Export Key Invalid With Value To HKLM Root To Invalid Folder
                      HKLM                        Testing Windows Registry    \            REG_SZ       999999         HKLM                           ${_WORKING_DIR}\\invalid\\invalid2.reg

Export Key Invalid With Value To HKU Root To Invalid Folder
                      HKU                         Testing Windows Registry    \            REG_SZ       999999         HKU                            ${_WORKING_DIR}\\invalid\\invalid3.reg

Export Key Invalid With Value To HKCU To Invalid Folder
                      HKCU\\.1WinRegistryTest     Testing Windows Registry    \            REG_SZ       999999         HKCU\\.1WinRegistryTesting     ${_WORKING_DIR}\\invalid\\invalid4.reg

Export Key Invalid With Value to HKCC To Invalid Folder
                      HKCC\\.1WinRegistryTest     Testing Windows Registry    \            REG_SZ       999999         HKCC\\.1WinRegistryTesting     ${_WORKING_DIR}\\invalid\\invalid5.reg

Export Key Invalid With Wrong Key
                      HKCR\\.1WinRegistryTest1    Testing Registry 1          \            REG_SZ       \              HKCR\\.1WinRegistryTest111     ${_WORKING_DIR}\\export\\export.reg

Export Key Invalid With Wrong Key HKCR
                      HKCR\\.1WinRegistryTest     Testing Windows Registry    \            REG_SZ       999999         HKCR\\.1WinRegistryTesting1    ${_WORKING_DIR}\\export\\export.reg

Export Key Invalid With Wrong Key HKLM Root
                      HKLM                        Testing Windows Registry    \            REG_SZ       999999         HKLM1                          ${_WORKING_DIR}\\export\\export.reg

Export Key Invalid With Wrong Key HKU Root
                      HKU                         Testing Windows Registry    \            REG_SZ       999999         HKU1                           ${_WORKING_DIR}\\export\\export.reg

Export Key Invalid With Wrong Key HKCU
                      HKCU\\.1WinRegistryTest     Testing Windows Registry    \            REG_SZ       999999         HKCU\\.1WinRegistryTesting1    ${_WORKING_DIR}\\export\\export.reg

Export Key Invalid With Wrong Key HKCC
                      HKCC\\.1WinRegistryTest     Testing Windows Registry    \            REG_SZ       999999         HKCC\\.1WinRegistryTesting1    ${_WORKING_DIR}\\export\\export.reg

*** Keywords ***
Suite Setup
    Init AE And Package
    Init Registry Server

Add Key Template
    [Arguments]    ${keyName}    ${keyValue}    ${separator}    ${dataType}    ${assignData}    ${keyName2}
    ...    ${file}
    Init Action    ${ACTION_DELETE_KEY}
    Action Set    ${PRT_REG_KEY}    ${keyName}
    Action Set    ${PRT_REG_OPTION_KEYVALUE}    ${keyValue}
    #Action Set    ${PRT_REG_OPTION_DEFAULT}    ${default1}
    Action Execute
    Init Action    ${ACTION_ADD_KEY}
    Action Set    ${PRT_REG_KEY}    ${keyName}
    Action Set    ${PRT_REG_OPTION_KEYVALUE}    ${keyValue}
    #Action Set    ${PRT_REG_OPTION_DEFAULT}    ${default2}
    Action Set    ${PRT_REG_OPTION_USE_SEPARATOR}    ${separator}
    Action Set    ${PRT_REG_OPTION_SRCH_TYPE}    ${dataType}
    Action Set    ${PRT_REG_OPTION_ASSIGN_DATA}    ${assignData}
    Action Execute
    Init Action    ${ACTION_EXPORT_KEY}
    Action Set    ${PRT_REG_KEY}    ${keyName2}
    Action Set    ${PRT_REG_FILE}    ${file}
    Action Execute
    Action Report Should Be Found
    Action Return Code Should Be    1
    Action Return Status Should Be    ${ENDED_NOT_OK - aborted}
    Action Report Should Contain    ${ErrorExportingKey}
    Action Report Should Contain    START AT
    #Action Report Should Contain    PARAMETER VALIDATION START
    #Action Report Should Contain    EXECUTION START
    #Action Report Should Contain    ABEND AT
    #Action Report Should Contain    RET-CODE
